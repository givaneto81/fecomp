<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bem-vindo ao Educa AI</title>
    <link rel="icon" href="{{ url_for('static', filename='imagens/logo.png') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <style>
        /* Estilos espec√≠ficos para o tutorial */
        body.tutorial-page {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: var(--bg-color);
        }
        .tutorial-container {
            background-color: var(--content-bg-color);
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 4px 20px var(--shadow-color);
            text-align: center;
            width: 90%;
            max-width: 600px;
            overflow: hidden; /* Para a transi√ß√£o dos slides */
        }
        .tutorial-slider {
            display: flex;
            transition: transform 0.4s ease-in-out;
        }
        .tutorial-etapa {
            min-width: 100%;
            box-sizing: border-box;
        }
        .tutorial-etapa h2 {
            font-size: 2em;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        .tutorial-etapa p {
            font-size: 1.1em;
            color: var(--text-color-light);
            line-height: 1.6;
        }
        .tutorial-nav {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .btn-tutorial {
            background-color: var(--primary-color);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-tutorial:hover {
            background-color: var(--primary-hover-color);
        }
        .btn-tutorial[disabled] {
            background-color: var(--text-color-light);
            cursor: not-allowed;
        }
        .etapa-indicadores span {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--border-color);
            margin: 0 5px;
            transition: background-color 0.3s;
        }
        .etapa-indicadores span.active {
            background-color: var(--primary-color);
        }
    </style>
</head>
<body class="tutorial-page">

    <div class="tutorial-container">
        <div class="tutorial-slider">
            <div class="tutorial-etapa" id="etapa-1">
                <h2>üéì Bem-vindo(a) ao Educa AI!</h2>
                <p>O seu novo assistente de estudos para o SSA e ENEM. Aqui, pode organizar todo o seu material e tirar d√∫vidas com uma IA poderosa.</p>
            </div>
            <div class="tutorial-etapa" id="etapa-2">
                <h2>üìò Organize-se como nunca</h2>
                <p>Crie <strong>Mat√©rias</strong> (como "Matem√°tica" ou "Hist√≥ria"), dentro delas crie <strong>Pastas</strong> (como "Provas Antigas") e envie os seus <strong>Ficheiros</strong> (PDFs, imagens, etc.).</p>
            </div>
            <div class="tutorial-etapa" id="etapa-3">
                <h2>üí¨ Tire d√∫vidas a qualquer hora</h2>
                <p>Use o nosso <strong>Chat IA</strong> para explicar t√≥picos, resolver problemas e obter resumos. √â como ter um professor particular 24 horas por dia!</p>
            </div>
        </div>

        <div class="tutorial-nav">
            <button id="btn-anterior" class="btn-tutorial" style="visibility: hidden;">Anterior</button>
            <div class="etapa-indicadores">
                <span class="active"></span><span></span><span></span>
            </div>
            <button id="btn-proximo" class="btn-tutorial">Pr√≥ximo</button>
            <button id="btn-comecar" class="btn-tutorial" style="display: none;">Come√ßar a estudar!</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const slider = document.querySelector('.tutorial-slider');
            const btnAnterior = document.getElementById('btn-anterior');
            const btnProximo = document.getElementById('btn-proximo');
            const btnComecar = document.getElementById('btn-comecar');
            const indicadores = document.querySelectorAll('.etapa-indicadores span');
            
            let etapaAtual = 0;
            const totalEtapas = 3;

            function atualizarInterface() {
                slider.style.transform = `translateX(-${etapaAtual * 100}%)`;
                
                // Atualiza bot√µes
                btnAnterior.style.visibility = etapaAtual === 0 ? 'hidden' : 'visible';
                btnProximo.style.display = etapaAtual === totalEtapas - 1 ? 'none' : 'block';
                btnComecar.style.display = etapaAtual === totalEtapas - 1 ? 'block' : 'none';

                // Atualiza indicadores
                indicadores.forEach((indicador, index) => {
                    indicador.classList.toggle('active', index === etapaAtual);
                });
            }

            btnProximo.addEventListener('click', () => {
                if (etapaAtual < totalEtapas - 1) {
                    etapaAtual++;
                    atualizarInterface();
                }
            });

            btnAnterior.addEventListener('click', () => {
                if (etapaAtual > 0) {
                    etapaAtual--;
                    atualizarInterface();
                }
            });

            btnComecar.addEventListener('click', async () => {
                btnComecar.disabled = true;
                btnComecar.textContent = 'Aguarde...';

                try {
                    const response = await fetch('/api/utilizador/concluir_tutorial', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        }
                    });

                    if (!response.ok) {
                        throw new Error('Falha ao guardar o progresso.');
                    }
                    
                    btnComecar.textContent = 'Conclu√≠do!';
                    // Redireciona para a p√°gina de in√≠cio ap√≥s sucesso
                    window.location.href = "{{ url_for('visoes.pagina_inicio') }}";

                } catch (error) {
                    console.error('Erro:', error);
                    alert('Ocorreu um erro. Por favor, tente novamente.');
                    btnComecar.disabled = false;
                    btnComecar.textContent = 'Come√ßar a estudar!';
                }
            });
        });
    </script>
</body>
</html>